<div class="container mt-4">
  <h2 class="mb-4 text-center">üìã Solicitudes de Cr√©dito</h2>

  <div *ngIf="mensaje" class="alert alert-info">{{ mensaje }}</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="cargando" class="text-center">Cargando...</div>

  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover align-middle" *ngIf="creditos.length > 0">
      <thead class="table-dark">
        <tr class="text-center text-nowrap">
          <th>ID</th>
          <th>Usuario</th>
          <th>Producto</th>
          <th>Monto</th>
          <th>Monto Final</th>
          <th>Cuotas</th>
          <th>Estado</th>
          <th>Fecha</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let credito of creditos" class="text-center text-wrap">
          <td>{{ credito.id }}</td>
          <td class="text-break">{{ credito.usuario?.nombre || credito.usuario?.email }}</td>
          <td class="text-break">{{ credito.producto.nombre }}</td>
          <td>${{ credito.montoSolicitado }}</td>
          <td>${{ credito.montoFinal }}</td>
          <td>{{ credito.cuotas }}</td>
          <td>
            <span class="badge px-3 py-2 fs-6"
                  [ngClass]="{
                    'bg-warning text-dark': credito.estado === 'PENDIENTE',
                    'bg-success': credito.estado === 'APROBADO',
                    'bg-danger': credito.estado === 'RECHAZADO'
                  }">
              {{ credito.estado }}
            </span>
          </td>
          <td>{{ credito.fechaSolicitud | date:'short' }}</td>
          <td>
            <div class="d-grid gap-1">
              <button class="btn btn-success btn-sm"
                      (click)="aprobar(credito.id!)"
                      [disabled]="credito.estado !== 'PENDIENTE'">
                ‚úÖ Aprobar
              </button>
              <button class="btn btn-danger btn-sm"
                      (click)="rechazar(credito.id!)"
                      [disabled]="credito.estado !== 'PENDIENTE'">
                ‚ùå Rechazar
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!cargando && creditos.length === 0" class="alert alert-secondary text-center mt-3">
    No hay solicitudes de cr√©dito registradas.
  </div>
</div>
